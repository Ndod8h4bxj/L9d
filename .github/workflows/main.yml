name: Create AWS VPS

on:
  workflow_dispatch:

jobs:
  setup-vps:
    runs-on: ubuntu-latest

    steps:
      - name: Install AWS CLI
        run: |
          sudo apt update && sudo apt install -y awscli
          aws --version
      
      - name: Configure AWS CLI
        env:
          AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
          AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
        run: |
          aws configure set aws_access_key_id $AWS_ACCESS_KEY_ID
          aws configure set aws_secret_access_key $AWS_SECRET_ACCESS_KEY
          aws configure set default.region us-east-1

      - name: Launch EC2 Instance
        run: |
          aws ec2 run-instances \
            --image-id ami-12345678 \ # Replace with Ubuntu 22.04 AMI ID
            --count 1 \
            --instance-type t2.micro \
            --key-name your-key-pair \
            --security-group-ids sg-12345678 \
            --subnet-id subnet-12345678 \
            --tag-specifications 'ResourceType=instance,Tags=[{Key=Name,Value=GitHub-VPS}]'
